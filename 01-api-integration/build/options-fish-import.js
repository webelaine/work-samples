(()=>{let e={};function t(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n].querySelector("input"),i=o.id.substring(o.id.indexOf("[")+1,o.id.indexOf("]"));t[i]||(t[i]=[]),t[i].push(e[n])}return t}function n(e){return e.match(/\d+/)}function o(){const t=this.dataset.field;let o="locations";t.includes("regions")&&(o="regions");const i=t.substring(t.indexOf("[")+1,t.indexOf("]")),l=e[o][i];for(let e=0;e<l.length;e++)l[e].remove();e[o].splice(i,1),function(e,t){for(let o=0;o<e[t].length;o++){const i=e[t][o];for(let e=0;e<i.length;e++){const t=i[e],l=t.querySelector("th"),s=n(l.innerHTML);l.innerHTML=l.innerHTML.replace(s[0],o+1);const c=t.querySelector("input"),r=n(c.id);c.id=c.id.replace(r[0],o);const a=n(c.name);c.name=c.name.replace(a[0],o);const d=t.querySelector("button");if(d){d.dataset.field=d.dataset.field.replace(a[0],o);const e=n(d.innerHTML);d.innerHTML=d.innerHTML.replace(e[0],o+1)}}}}(e,o)}function i(e){for(let t=0;t<e.length;t++)e[t][0].getElementsByClassName("remove")[0].addEventListener("click",o)}function l(e,t){const n=document.createElement("table");n.className="form-table",n.dataset.field=e,"regions"===e?t.regionButton.after(n):t.locationButton.after(n);const o=document.createElement("tbody");n.appendChild(o)}function s(t,n){const i=[],l=n.toLowerCase()+"Table",s=document.createElement("tr"),c=document.createElement("th");c.innerHTML=n+" "+(t+1)+" Name",c.scope="row",s.appendChild(c);const r=document.createElement("td"),a=document.createElement("input");a.type="text",a.id="fishrules_"+n.toLowerCase()+"s["+t+"][name]",a.name=a.id,r.appendChild(a);const d=document.createElement("button");d.type="button",d.class="remove",d.dataset.field="fishrules_"+n.toLowerCase()+"s["+t+"]",d.textContent="Remove "+n+" "+(t+1),d.addEventListener("click",o),r.appendChild(d),s.appendChild(r),i.push(s),e[l].querySelector("tbody").appendChild(s);const u=document.createElement("tr"),m=document.createElement("th");m.innerHTML=n+" "+(t+1)+" Coordinates",m.scope="row",u.appendChild(m);const p=document.createElement("td"),h=document.createElement("input");if(h.type="text",h.id="fishrules_"+n.toLowerCase()+"s["+t+"][coords]",h.name=h.id,p.appendChild(h),u.appendChild(p),i.push(u),e[l].querySelector("tbody").appendChild(u),"Region"===n){const o=document.createElement("tr"),s=document.createElement("th");s.innerHTML=n+" "+(t+1)+" Species ID",s.scope="row",o.appendChild(s);const c=document.createElement("td"),r=document.createElement("input");r.type="text",r.id="fishrules_"+n.toLowerCase()+"s["+t+"][species_id]",r.name=r.id,c.appendChild(r),o.appendChild(c),i.push(o),e[l].querySelector("tbody").appendChild(o)}"Location"===n?Array.isArray(e.locations)?e.locations.push(i):e.locations=[i]:Array.isArray(e.regions)?e.regions.push(i):e.regions=[i]}function c(){let t=0;"locations"===this.dataset.field?(e.locations&&e.locations.length&&(t=e.locations.length),s(t,"Location")):(e.regions&&e.regions.length&&(t=e.regions.length),s(t,"Region"))}e=function(){const e=document.getElementsByClassName("form-table"),n={};for(let o=2;o<e.length;o++){const l=e[o].querySelectorAll("tr");if(2===o){const e=t(l);n.locations=e,n.locations.length&&i(n.locations)}else{const e=t(l);n.regions=e,n.regions.length&&i(n.regions)}}const o=document.getElementsByClassName("add");for(let e=0;e<o.length;e++){const t=o[e];t.addEventListener("click",c),"locations"===t.dataset.field?(n.locationButton=t,n.locationTable=t.nextElementSibling):(n.regionButton=t,n.regionTable=t.nextElementSibling)}return n.locations||(l("locations",n),n.locationTable=n.locationButton.nextElementSibling),n.regions||(l("regions",n),n.regionTable=n.regionButton.nextElementSibling),n}()})();